<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="egovframework.let.crud.service.impl.CrudMapper">
<!-- mapper 패키지 경로명 / namespace가 해당 mapper을 가지고 오게 해주는 경로 역할을 한다 -->
	<resultMap id="crud" type="egovframework.let.crud.service.CrudVO">
		<result property="crudId" column="CRUD_ID"/>
		<result property="crudSj" column="CRUD_SJ"/>
		<result property="crudCn" column="CRUD_CN"/>
		<result property="userNm" column="USER_NM"/>
		<result property="frstRegistPnttm" column="FRST_REGIST_PNTTM"/>
	</resultMap>
		
	<select id="selectCrud"	resultType="egovframework.let.crud.service.CrudVO">  <!-- 3.변경 -->
	<!-- ** 이렇게 작성해도 됨
	<select id="selectCrud"	resultMap="crud">
			SELECT
		CRUD_ID as crudId
		,	CRUD_SJ
		,	CRUD_CN
		,	USER_NM
		, FRST_REGIST_PNTTM
		FROM letcrud
		WHERE CRUD_ID = #{crudId} -->
	<!-- resultType이 아니라 resultMap사용하는 이유 1. 쿼리 줄 라인이 줄어듦 / 2. 속도향상 /3. 쿼리의 'AS VO변수' 사용하지 않아도 됨 -->
		SELECT
		CRUD_ID as crudId
		,	CRUD_SJ as crudSj
		,	CRUD_CN as crudCn
		,	USER_NM as userNm
		, FRST_REGIST_PNTTM as frstRegistPnttm
		FROM letcrud
		WHERE CRUD_ID = #{crudId}
	</select>
	<!-- **쿼리 제대로 짰는지 확인하기 위해서 sql 돌려보기!** -->

	<select id="selectCrudList" resultType="egovMap">
		SELECT
		CRUD_ID, CRUD_SJ, CRUD_CN, USER_NM, DATE_FORMAT(FRST_REGIST_PNTTM, '%Y-%m-%d') AS FRST_REGIST_PNTTM
		<!-- 날짜 표기할 때 대소문자 구별 잘 해야한다, %y와 %Y가 다른 것처럼 -->
		FROM letcrud
		ORDER BY CRUD_ID DESC
		LIMIT #{recordCountPerPage} OFFSET #{firstIndex}
		<!-- 페이지 수 표기해줌 -->
	</select>
	
	<insert id="insertCrud"	parameterType="egovframework.let.crud.service.CrudVO">
		INSERT INTO letcrud (
		CRUD_ID, CRUD_SJ, CRUD_CN, USER_NM, FRST_REGIST_PNTTM
		) VALUES (
		#{crudId}, #{crudSj}, #{crudCn}, #{userNm}, NOW()
		)
	</insert>
	
	<update id="updateCrud"	parameterType="egovframework.let.crud.service.CrudVO">
		UPDATE letcrud SET
		CRUD_SJ = #{crudSj},
		CRUD_CN = #{crudCn},
		USER_NM = #{userNm}
		WHERE CRUD_ID = #{crudId}
	</update>
	
	<delete id="deleteCrud"	parameterType="egovframework.let.crud.service.CrudVO">
		DELETE FROM letcrud
		WHERE CRUD_ID = #{crudId}
	</delete>
	
	<select id="selectCrudListCnt" resultType="java.lang.Integer">
		SELECT COUNT(*) CNT
		FROM letcrud
	</select>
</mapper>